services:
  folia:
    tty: true
    stdin_open: true
    image: itzg/minecraft-server:java24
    restart: unless-stopped
    ports:
      - "25565:25565"
      - "25565:25565/udp"
      - "25575:25575"   # üëà –æ—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ—Ä—Ç –¥–ª—è RCON
    environment:
      EULA: "TRUE"
      TYPE: "FOLIA"
      VERSION: "1.21.8"
      MEMORY: "4G"
      JVM_XX_OPTS: "-XX:MaxRAMPercentage=75"
      ONLINE_MODE: "FALSE"
      MAX_PLAYERS: 300
      SERVER_NAME: "Cloudea.org | Minecraft"
      MOTD: "¬ßa–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ Cloudea!"
      DIFFICULTY: "normal"
      VIEW_DISTANCE: 8
      SIMULATION_DISTANCE: 6

      # üîπ RCON
      ENABLE_RCON: "true"
      RCON_PASSWORD: "super_secret_passz"
      RCON_PORT: 25575

      # üîπ –ê–≤—Ç–æ-–±—ç–∫–∞–ø—ã
      ENABLE_AUTOBACKUP: "true"
      AUTOBACKUP_INTERVAL: "2h"
      AUTOBACKUP_KEEP: "7d"
      AUTOBACKUP_METHOD: "tar"
    volumes:
      - ./data:/data
      - ./plugins:/data/plugins
      - ./config:/data/config

  backend:
    build: ./backend
    container_name: mc-backend
    restart: unless-stopped
    depends_on:
      - folia
    ports:
      - "8000:8000"   # –≤–µ–±—Ö—É–∫–∏ Tribute —Å—é–¥–∞
    environment:
      RCON_HOST: "folia"
      RCON_PORT: 25575
      RCON_PASSWORD: "super_secret_passz"
      ALLOWED_DONATION_NAME: "Whitelist –¥–æ—Å—Ç—É–ø"
      DONATE_CURRENCY: "EUR"
      DONATE_AMOUNT: 1
    volumes:
      - ./logs:/logs   # —Å—é–¥–∞ –±—É–¥—É—Ç –ø–∏—Å–∞—Ç—å—Å—è success/errors
